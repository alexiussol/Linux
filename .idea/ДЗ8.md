1. Переустановить операционную систему (по желанию, для дополнительной практики)
2. Подключить репозиторий Docker.
3. Запустить контейнер с Ubuntu.
4. * Используя Dockerfile, собрать связку nginx + PHP-FPM в одном контейнере.

alexei@alexei-VirtualBox:~$ sudo apt update && sudo apt upgrade

[sudo] пароль для alexei: 

Сущ:1 http://ru.archive.ubuntu.com/ubuntu jammy InRelease

Пол:2 http://ru.archive.ubuntu.com/ubuntu jammy-updates InRelease [114 kB]

Пол:3 http://ru.archive.ubuntu.com/ubuntu jammy-backports InRelease [99,8 kB]  

Сущ:4 http://security.ubuntu.com/ubuntu jammy-security InRelease               

Игн:5 https://nginx.org/packages/mainline/debian jammy InRelease              

Ошб:6 https://nginx.org/packages/mainline/debian jammy Release

  404  Not Found [IP: 3.125.197.172 443]

Чтение списков пакетов… Готово

E: Репозиторий «https://nginx.org/packages/mainline/debian jammy Release» не содержит файла Release.

N: Обновление из этого репозитория нельзя выполнить безопасным способом, поэтому по умолчанию он отключён.

N: Информацию о создании репозитория и настройках пользователя смотрите в справочной странице apt-secure(8).

alexei@alexei-VirtualBox:~$ sudo apt install linux-image-extra-$(uname -r) linux-image-extra-virtual

Чтение списков пакетов… Готово

Построение дерева зависимостей… Готово

Чтение информации о состоянии… Готово         

E: Невозможно найти пакет linux-image-extra-5.15.0-40-generic

E: Не удалось найти ни один пакет с помощью шаблона «linux-image-extra-5.15.0-40-generic»

alexei@alexei-VirtualBox:~$ sudo apt install apt-transport-https ca-certificates curl software-properties-common

Чтение списков пакетов… Готово

Построение дерева зависимостей… Готово

Чтение информации о состоянии… Готово         

Уже установлен пакет ca-certificates самой новой версии (20211016).

ca-certificates помечен как установленный вручную.

Уже установлен пакет curl самой новой версии (7.81.0-1ubuntu1.3).

Следующие пакеты устанавливались автоматически и больше не требуются:

  libnginx-mod-http-geoip2 libnginx-mod-http-image-filter libnginx-mod-http-xslt-filter libnginx-mod-mail libnginx-mod-stream

  libnginx-mod-stream-geoip2 nginx-common

Для их удаления используйте «sudo apt autoremove».

Следующие НОВЫЕ пакеты будут установлены:

  apt-transport-https

Следующие пакеты будут обновлены:

  python3-software-properties software-properties-common software-properties-gtk

Обновлено 3 пакетов, установлено 1 новых пакетов, для удаления отмечено 0 пакетов, и 289 пакетов не обновлено.

Необходимо скачать 110 kB архивов.

После данной операции объём занятого дискового пространства возрастёт на 169 kB.

Пол:1 http://ru.archive.ubuntu.com/ubuntu jammy-updates/universe amd64 apt-transport-https all 2.4.7 [1 512 B]

Пол:2 http://ru.archive.ubuntu.com/ubuntu jammy-updates/main amd64 software-properties-common all 0.99.22.3 [14,1 kB]

Пол:3 http://ru.archive.ubuntu.com/ubuntu jammy-updates/main amd64 software-properties-gtk all 0.99.22.3 [65,2 kB]

Пол:4 http://ru.archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3-software-properties all 0.99.22.3 [28,8 kB]

Получено 110 kB за 1с (135 kB/s)                  

Выбор ранее не выбранного пакета apt-transport-https.

(Чтение базы данных … на данный момент установлено 204458 файлов и каталогов.)

Подготовка к распаковке …/apt-transport-https_2.4.7_all.deb …

Распаковывается apt-transport-https (2.4.7) …

Подготовка к распаковке …/software-properties-common_0.99.22.3_all.deb …

Распаковывается software-properties-common (0.99.22.3) на замену (0.99.22) …

Подготовка к распаковке …/software-properties-gtk_0.99.22.3_all.deb …

Распаковывается software-properties-gtk (0.99.22.3) на замену (0.99.22) …

Подготовка к распаковке …/python3-software-properties_0.99.22.3_all.deb …

Распаковывается python3-software-properties (0.99.22.3) на замену (0.99.22) …

Настраивается пакет apt-transport-https (2.4.7) …

Настраивается пакет python3-software-properties (0.99.22.3) …

Настраивается пакет software-properties-common (0.99.22.3) …

Настраивается пакет software-properties-gtk (0.99.22.3) …

Обрабатываются триггеры для dbus (1.12.20-2ubuntu4) …

Обрабатываются триггеры для shared-mime-info (2.1-2) …

Обрабатываются триггеры для mailcap (3.70+nmu1ubuntu1) …

Обрабатываются триггеры для desktop-file-utils (0.26-1ubuntu3) …

Обрабатываются триггеры для hicolor-icon-theme (0.17-2) …

Обрабатываются триггеры для gnome-menus (3.36.0-1ubuntu3) …

Обрабатываются триггеры для libglib2.0-0:amd64 (2.72.1-1) …

Обрабатываются триггеры для man-db (2.10.2-1) …

alexei@alexei-VirtualBox:~$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -

Warning: apt-key is deprecated. Manage keyring files in trusted.gpg.d instead (see apt-key(8)).

OK

alexei@alexei-VirtualBox:~$ sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable"

Репозиторий: 'deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable'

Описание:

Archive for codename: bionic components: stable

Дополнительные сведения: https://download.docker.com/linux/ubuntu

Добавление репозитория.

Press [ENTER] to continue or Ctrl-c to cancel.

Adding deb entry to /etc/apt/sources.list.d/archive_uri-https_download_docker_com_linux_ubuntu-jammy.list

Adding disabled deb-src entry to /etc/apt/sources.list.d/archive_uri-https_download_docker_com_linux_ubuntu-jammy.list

Сущ:1 http://ru.archive.ubuntu.com/ubuntu jammy InRelease

Пол:2 http://ru.archive.ubuntu.com/ubuntu jammy-updates InRelease [114 kB]                                                         

Сущ:3 http://security.ubuntu.com/ubuntu jammy-security InRelease                                                                   

Пол:4 https://download.docker.com/linux/ubuntu bionic InRelease [64,4 kB]                                                          

Пол:5 http://ru.archive.ubuntu.com/ubuntu jammy-backports InRelease [99,8 kB]                                   

Пол:6 https://download.docker.com/linux/ubuntu bionic/stable amd64 Packages [26,6 kB]        

Игн:7 https://nginx.org/packages/mainline/debian jammy InRelease                                                  

Ошб:8 https://nginx.org/packages/mainline/debian jammy Release               

  404  Not Found [IP: 52.58.199.22 443]

Чтение списков пакетов… Готово       

W: https://download.docker.com/linux/ubuntu/dists/bionic/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.

E: Репозиторий «https://nginx.org/packages/mainline/debian jammy Release» не содержит файла Release.

N: Обновление из этого репозитория нельзя выполнить безопасным способом, поэтому по умолчанию он отключён.

N: Информацию о создании репозитория и настройках пользователя смотрите в справочной странице apt-secure(8).

alexei@alexei-VirtualBox:~$ sudo apt update && apt-cache policy docker-ce

Сущ:1 http://ru.archive.ubuntu.com/ubuntu jammy InRelease

Пол:2 http://ru.archive.ubuntu.com/ubuntu jammy-updates InRelease [114 kB]                                                         

Сущ:3 http://security.ubuntu.com/ubuntu jammy-security InRelease                                                                   

Сущ:4 https://download.docker.com/linux/ubuntu bionic InRelease                                                                    

Пол:5 http://ru.archive.ubuntu.com/ubuntu jammy-backports InRelease [99,8 kB]                                                

Игн:6 https://nginx.org/packages/mainline/debian jammy InRelease                       

Ошб:7 https://nginx.org/packages/mainline/debian jammy Release              

  404  Not Found [IP: 3.125.197.172 443]

Чтение списков пакетов… Готово      

W: https://download.docker.com/linux/ubuntu/dists/bionic/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.

E: Репозиторий «https://nginx.org/packages/mainline/debian jammy Release» не содержит файла Release.

N: Обновление из этого репозитория нельзя выполнить безопасным способом, поэтому по умолчанию он отключён.

N: Информацию о создании репозитория и настройках пользователя смотрите в справочной странице apt-secure(8).

alexei@alexei-VirtualBox:~$ sudo apt install -y docker-ce

Чтение списков пакетов… Готово

Построение дерева зависимостей… Готово

Чтение информации о состоянии… Готово         

Следующие пакеты устанавливались автоматически и больше не требуются:

  libnginx-mod-http-geoip2 libnginx-mod-http-image-filter libnginx-mod-http-xslt-filter libnginx-mod-mail libnginx-mod-stream

  libnginx-mod-stream-geoip2 nginx-common

Для их удаления используйте «sudo apt autoremove».

Будут установлены следующие дополнительные пакеты:

  containerd.io docker-ce-cli docker-ce-rootless-extras docker-scan-plugin git git-man liberror-perl libslirp0 pigz slirp4netns

Предлагаемые пакеты:

  aufs-tools cgroupfs-mount | cgroup-lite git-daemon-run | git-daemon-sysvinit git-doc git-email git-gui gitk gitweb git-cvs

  git-mediawiki git-svn

Следующие НОВЫЕ пакеты будут установлены:

  containerd.io docker-ce docker-ce-cli docker-ce-rootless-extras docker-scan-plugin git git-man liberror-perl libslirp0 pigz

  slirp4netns

Обновлено 0 пакетов, установлено 11 новых пакетов, для удаления отмечено 0 пакетов, и 289 пакетов не обновлено.

Необходимо скачать 106 MB архивов.

После данной операции объём занятого дискового пространства возрастёт на 443 MB.

Пол:1 http://ru.archive.ubuntu.com/ubuntu jammy/universe amd64 pigz amd64 2.6-1 [63,6 kB]

Пол:2 http://ru.archive.ubuntu.com/ubuntu jammy/main amd64 liberror-perl all 0.17029-1 [26,5 kB]

Пол:3 http://ru.archive.ubuntu.com/ubuntu jammy-updates/main amd64 git-man all 1:2.34.1-1ubuntu1.4 [952 kB]

Пол:4 https://download.docker.com/linux/ubuntu bionic/stable amd64 containerd.io amd64 1.6.7-1 [28,1 MB]

Пол:5 http://ru.archive.ubuntu.com/ubuntu jammy-updates/main amd64 git amd64 1:2.34.1-1ubuntu1.4 [3 131 kB]

Пол:6 http://ru.archive.ubuntu.com/ubuntu jammy/main amd64 libslirp0 amd64 4.6.1-1build1 [61,5 kB]                                 

Пол:7 http://ru.archive.ubuntu.com/ubuntu jammy/universe amd64 slirp4netns amd64 1.0.1-2 [28,2 kB]                                 

Пол:8 https://download.docker.com/linux/ubuntu bionic/stable amd64 docker-ce-cli amd64 5:20.10.17~3-0~ubuntu-bionic [40,6 MB]      

Пол:9 https://download.docker.com/linux/ubuntu bionic/stable amd64 docker-ce amd64 5:20.10.17~3-0~ubuntu-bionic [21,0 MB]          

Пол:10 https://download.docker.com/linux/ubuntu bionic/stable amd64 docker-ce-rootless-extras amd64 5:20.10.17~3-0~ubuntu-bionic [8 163 kB]

Пол:11 https://download.docker.com/linux/ubuntu bionic/stable amd64 docker-scan-plugin amd64 0.17.0~ubuntu-bionic [3 521 kB]       

Получено 106 MB за 2мин 52с (613 kB/s)                                                                                             

Выбор ранее не выбранного пакета pigz.

(Чтение базы данных … на данный момент установлено 204462 файла и каталога.)

Подготовка к распаковке …/00-pigz_2.6-1_amd64.deb …

Распаковывается pigz (2.6-1) …

Выбор ранее не выбранного пакета containerd.io.

Подготовка к распаковке …/01-containerd.io_1.6.7-1_amd64.deb …

Распаковывается containerd.io (1.6.7-1) …

Выбор ранее не выбранного пакета docker-ce-cli.

Подготовка к распаковке …/02-docker-ce-cli_5%3a20.10.17~3-0~ubuntu-bionic_amd64.deb …

Распаковывается docker-ce-cli (5:20.10.17~3-0~ubuntu-bionic) …

Выбор ранее не выбранного пакета docker-ce.

Подготовка к распаковке …/03-docker-ce_5%3a20.10.17~3-0~ubuntu-bionic_amd64.deb …

Распаковывается docker-ce (5:20.10.17~3-0~ubuntu-bionic) …

Выбор ранее не выбранного пакета docker-ce-rootless-extras.

Подготовка к распаковке …/04-docker-ce-rootless-extras_5%3a20.10.17~3-0~ubuntu-bionic_amd64.deb …

Распаковывается docker-ce-rootless-extras (5:20.10.17~3-0~ubuntu-bionic) …

Выбор ранее не выбранного пакета docker-scan-plugin.

Подготовка к распаковке …/05-docker-scan-plugin_0.17.0~ubuntu-bionic_amd64.deb …

Распаковывается docker-scan-plugin (0.17.0~ubuntu-bionic) …

Выбор ранее не выбранного пакета liberror-perl.

Подготовка к распаковке …/06-liberror-perl_0.17029-1_all.deb …

Распаковывается liberror-perl (0.17029-1) …

Выбор ранее не выбранного пакета git-man.

Подготовка к распаковке …/07-git-man_1%3a2.34.1-1ubuntu1.4_all.deb …

Распаковывается git-man (1:2.34.1-1ubuntu1.4) …

Выбор ранее не выбранного пакета git.

Подготовка к распаковке …/08-git_1%3a2.34.1-1ubuntu1.4_amd64.deb …

Распаковывается git (1:2.34.1-1ubuntu1.4) …

Выбор ранее не выбранного пакета libslirp0:amd64.

Подготовка к распаковке …/09-libslirp0_4.6.1-1build1_amd64.deb …

Распаковывается libslirp0:amd64 (4.6.1-1build1) …

Выбор ранее не выбранного пакета slirp4netns.

Подготовка к распаковке …/10-slirp4netns_1.0.1-2_amd64.deb …

Распаковывается slirp4netns (1.0.1-2) …

Настраивается пакет docker-scan-plugin (0.17.0~ubuntu-bionic) …

Настраивается пакет liberror-perl (0.17029-1) …

Настраивается пакет containerd.io (1.6.7-1) …

Created symlink /etc/systemd/system/multi-user.target.wants/containerd.service → /lib/systemd/system/containerd.service.

Настраивается пакет docker-ce-cli (5:20.10.17~3-0~ubuntu-bionic) …

Настраивается пакет libslirp0:amd64 (4.6.1-1build1) …

Настраивается пакет pigz (2.6-1) …

Настраивается пакет git-man (1:2.34.1-1ubuntu1.4) …

Настраивается пакет docker-ce-rootless-extras (5:20.10.17~3-0~ubuntu-bionic) …

Настраивается пакет slirp4netns (1.0.1-2) …

Настраивается пакет docker-ce (5:20.10.17~3-0~ubuntu-bionic) …

Created symlink /etc/systemd/system/multi-user.target.wants/docker.service → /lib/systemd/system/docker.service.

Created symlink /etc/systemd/system/sockets.target.wants/docker.socket → /lib/systemd/system/docker.socket.

Настраивается пакет git (1:2.34.1-1ubuntu1.4) …

Обрабатываются триггеры для man-db (2.10.2-1) …

Обрабатываются триггеры для libc-bin (2.35-0ubuntu3) …

alexei@alexei-VirtualBox:~$ sudo usermod -aG docker $(whoami)

alexei@alexei-VirtualBox:~$ sudo systemctl status docker

● docker.service - Docker Application Container Engine

     Loaded: loaded (/lib/systemd/system/docker.service; enabled; vendor preset: enabled)

     Active: active (running) since Tue 2022-08-16 17:35:10 MSK; 1min 5s ago

TriggeredBy: ● docker.socket

       Docs: https://docs.docker.com

   Main PID: 5931 (dockerd)

      Tasks: 7

     Memory: 41.1M

        CPU: 229ms

     CGroup: /system.slice/docker.service

             └─5931 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock



авг 16 17:35:09 alexei-VirtualBox dockerd[5931]: time="2022-08-16T17:35:09.922644263+03:00" level=info msg="scheme \"unix\" not reg>

авг 16 17:35:09 alexei-VirtualBox dockerd[5931]: time="2022-08-16T17:35:09.922732241+03:00" level=info msg="ccResolverWrapper: send>

авг 16 17:35:09 alexei-VirtualBox dockerd[5931]: time="2022-08-16T17:35:09.922802385+03:00" level=info msg="ClientConn switching ba>

авг 16 17:35:09 alexei-VirtualBox dockerd[5931]: time="2022-08-16T17:35:09.982539546+03:00" level=info msg="Loading containers: sta>

авг 16 17:35:10 alexei-VirtualBox dockerd[5931]: time="2022-08-16T17:35:10.133515516+03:00" level=info msg="Default bridge (docker0>

авг 16 17:35:10 alexei-VirtualBox dockerd[5931]: time="2022-08-16T17:35:10.326905654+03:00" level=info msg="Loading containers: don>

авг 16 17:35:10 alexei-VirtualBox dockerd[5931]: time="2022-08-16T17:35:10.434336545+03:00" level=info msg="Docker daemon" commit=a>

авг 16 17:35:10 alexei-VirtualBox dockerd[5931]: time="2022-08-16T17:35:10.434748885+03:00" level=info msg="Daemon has completed in>

авг 16 17:35:10 alexei-VirtualBox systemd[1]: Started Docker Application Container Engine.

авг 16 17:35:10 alexei-VirtualBox dockerd[5931]: time="2022-08-16T17:35:10.472348528+03:00" level=info msg="API listen on /run/dock>

lines 1-22/22 (END)

lexei@alexei-VirtualBox:~$ sudo usermod -aG docker $USER

alexei@alexei-VirtualBox:~$ sudo service docker restart

alexei@alexei-VirtualBox:~$ sudo docker run hello-world

Unable to find image 'hello-world:latest' locally

latest: Pulling from library/hello-world

2db29710123e: Pull complete 

Digest: sha256:7d246653d0511db2a6b2e0436cfd0e52ac8c066000264b3ce63331ac66dca625

Status: Downloaded newer image for hello-world:latest



Hello from Docker!

This message shows that your installation appears to be working correctly.



To generate this message, Docker took the following steps:

 1. The Docker client contacted the Docker daemon.

 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.

    (amd64)

 3. The Docker daemon created a new container from that image which runs the

    executable that produces the output you are currently reading.

 4. The Docker daemon streamed that output to the Docker client, which sent it

    to your terminal.



To try something more ambitious, you can run an Ubuntu container with:

 $ docker run -it ubuntu bash



Share images, automate workflows, and more with a free Docker ID:

 https://hub.docker.com/



For more examples and ideas, visit:

 https://docs.docker.com/get-started/



alexei@alexei-VirtualBox:~$ 


